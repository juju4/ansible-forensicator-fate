---

- hosts: all
#- hosts: test-kitchen
  vars:
    - sift_docker: false
    - sift_include_volplugins: false
    - ffate_testing: true
    - jenkins_numExecutors: 3
    - jenkins_plugins:
      - parameterized-trigger
      - conditional-buildstep
## https://wiki.jenkins-ci.org/display/JENKINS/Rebuild+Plugin
      - rebuild
    - jenkins_java_options: "-Djenkins.install.runSetupWizard=false -Dmail.smtp.starttls.enable=true -Dhudson.DNSMultiCast.disabled=true -Dhudson.udp=-1 -Dhudson.model.DirectoryBrowserSupport.CSP=\\\"sandbox; default-src 'self'; img-src 'self'; style-src 'self' nvd3.org cdn.rawgit.com; script-src 'self' d3js.org nvd3.org cdn.rawgit.com\\\""
    - jenkins_init_changes:
      - {option: "JENKINS_ARGS", value: "--prefix={{ jenkins_url_prefix }}"}
      - {option: "JENKINS_JAVA_OPTIONS", value: "{{ jenkins_java_options }}"}
    - postgresql_databases:
      - name: webpy
        postgresql_users:
          - name: webpy
            priv: ALL
            db: webpy
  roles:
    - juju4.forensicator-fate

